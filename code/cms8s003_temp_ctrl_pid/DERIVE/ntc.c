#include "ntc.h"
#include "fun.h"

#if TCL_TEMP_COLL_SELECT == TCL_TEMP_NTC || (AUTOC_ENABLE == 1 && AUTOC_EXTI_TEMP_COMMON == 0)

extern code u32 ntcList[NTC_MAX_LIST+1];

float ntcTempCompute(float res)
{
	u16 i=0;
	res *= 10;
	if(res <= ntcList[NTC_MAX_LIST-1])
		return 240;
	else if(res >= ntcList[0])
		return 13;
	for(i=0;i<NTC_MAX_LIST;i++)
		if(res <= ntcList[i] && res >= ntcList[i+1])
		{
			return ((float)(res - ntcList[i+1]) / (float)(ntcList[i] - ntcList[i+1]))+(i+13);
		}
	return 0;
}

code u32 ntcList[NTC_MAX_LIST+1]={//130-240
1743100,//13
1665500,
1591900,
1521500,
1453800,
1388600,
1325600,
1264800,
1206400,
1150500,
1097300,
1047100,
1000000,
956290,
916170,
879850,
847520,
819400,
787200,
755710,
724860,
694670,
665200,
636540,
608820,
582160,
556710,
532600,
509970,
488940,
469630,
452150,
436600,
419260,
402880,
387400,
372730,
358800,
345540,
332890,
320770,
309130,
297900,
287030,
276470,
266170,
256100,
246200,
237290,
228690,
220390,
212390,
204700,
197300,
190200,
183390,
176870,
170630,
164670,
158990,
153570,
148420,
143530,
138950,
134560,
130340,
126280,
122360,
118570,
114890,
111300,
107810,
104390,
101040,
97748,
94509,
91314,
88160,
85316,
82625,
80068,
77628,
75290,
73039,
70864,
68750,
66689,
64670,
62685,
60725,
58785,
56858,
54940,
53450,
51947,
50444,
48952,
47480,
46039,
44635,
43277,
41970,
40720,
39531,
38408,
37353,
36369,
35460,
34391,
33399,
32472,
31602,
30780,
29998,
29248,
28524,
27820,
27131,//130
26450,
25775,
25100,
24423,
23740,
23060,
22411,
21792,
21202,
20640,//140
20105,
19595,
19111,
18650,
18213,
17798,
17405,
17032,
16680,
16347,
15884,
15456,
15057,
14685,
14334,
14001,
13683,//157
13377,
13080,
12789,
12502,
12217,
11933,
11646,
11357,
11094,
10841,
10597,
10361,
10133,//170
9912,
9698,
9490,
9288,
9092,
8901,
8714,
8532,
8355,
8181,
7979,
7796,
7626,
7471,
7324,
7186,
7054,
6926,
6800,
6676,
6551,
6424,
6295,
6161,
6023,
5923,
5818,
5709,
5596,
5482,
5368,
5254,
5142,
5033,
4927,//205
4825,
4727,
4635,
4548,
4467,
4383,
4300,
4219,
4139,
4060,
3983,
3907,
3833,
3761,
3690,
3621,
3553,
3488,
3423,
3361,
3305,
3248,
3189,
3131,
3073,
3016,
2958,
2903,
2848,
2795,
2744,
2695,
2648,
2604,
2562,//240
};

#endif
